global
  nbproc 1 # Number of processes to run HAProxy on
  maxconn 65536 # Maximum number of connections
 
# Clients will be able to access the server on port 80 over unsecured HTTP
frontend unsecured 
  bind *:3000
  mode http
  timeout client 86400000 # WebSockets can be kept open for a long time, to save time reconnecting
  option httpclose
  default_backend socket_io_servers
 
# The backend Socket.IO servers
backend socket_io_servers
  mode http
  balance roundrobin # Distribute clients evenly amongst servers
  timeout server 30000
  timeout connect 4000
  server server1 127.0.0.1:30001 weight 1 maxconn 10000 check # Our first server instance
  server server2 127.0.0.1:30002 weight 1 maxconn 10000 check # Our second server instance
